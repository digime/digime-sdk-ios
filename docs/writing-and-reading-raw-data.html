<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Writing And Reading Raw Data  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset="utf-8">
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
    <script src="js/lunr.min.js" defer></script>
    <script src="js/typeahead.jquery.js" defer></script>
    <script src="js/jazzy.search.js" defer></script>
  </head>
  <body>


    <a title="Writing And Reading Raw Data  Reference"></a>

    <header class="header">
      <p class="header-col header-col--primary">
        <a class="header-link" href="index.html">
          DigiMeSDK 5.0.2 Docs
        </a>
        
      </p>
    
      <p class="header-col--secondary">
        <form role="search" action="search.json">
          <input type="text" placeholder="Search documentation" data-typeahead>
        </form>
      </p>
    
        <p class="header-col header-col--secondary">
          <a class="header-link" href="https://github.com/digime/digime-sdk-ios">
            <img class="header-icon" src="img/gh.png"/>
            View on GitHub
          </a>
        </p>
    
    </header>

    <p class="breadcrumbs">
      <a class="breadcrumb" href="index.html">DigiMeSDK Reference</a>
      <img class="carat" src="img/carat.png" />
      Writing And Reading Raw Data  Reference
    </p>

    <div class="content-wrapper">
      <nav class="navigation">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="contributing.html">Contributing</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="error-handling.html">Error Handling</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="getting-started.html">Getting Started</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="scope.html">Scope</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="writing-and-reading-raw-data.html">Writing And Reading Raw Data</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CallbackService.html">CallbackService</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/CredentialCache.html">CredentialCache</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/DigiMe.html">DigiMe</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Classes/RawFileMetadataBuilder.html">RawFileMetadataBuilder</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/FileMetadata.html">FileMetadata</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/LogLevel.html">LogLevel</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/MimeType.html">MimeType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SDKError.html">SDKError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/SyncState.html">SyncState</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/TimeRange.html">TimeRange</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Enums/TimeRange/Unit.html">– Unit</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/APIError.html">APIError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Account.html">Account</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AccountServiceDescriptor.html">AccountServiceDescriptor</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/AccountsInfo.html">AccountsInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Configuration.html">Configuration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs.html#/s:9DigiMeSDK11CredentialsV">Credentials</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Duration.html">Duration</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/File.html">File</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/FileList.html">FileList</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/FileListItem.html">FileListItem</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Limits.html">Limits</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/MappedFileMetadata.html">MappedFileMetadata</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/RawFileMetadata.html">RawFileMetadata</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/RawFileMetadata/Account.html">– Account</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/RawFileMetadata/ObjectType.html">– ObjectType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ReadOptions.html">ReadOptions</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Scope.html">Scope</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/Service.html">Service</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServiceCountry.html">ServiceCountry</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServiceGroup.html">ServiceGroup</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServiceGroupScope.html">ServiceGroupScope</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServiceObjectType.html">ServiceObjectType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServiceType.html">ServiceType</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/ServicesInfo.html">ServicesInfo</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/SyncAccount.html">SyncAccount</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/SyncError.html">SyncError</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Structs/SyncStatus.html">SyncStatus</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a class="nav-group-name-link" href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:9DigiMeSDK10LogHandlera">LogHandler</a>
              </li>
              <li class="nav-group-task">
                <a class="nav-group-task-link" href="Typealiases.html#/s:9DigiMeSDK12LogLevelMaska">LogLevelMask</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">

        <section class="section">
          <div class="section-content top-matter">
            
            <p><img src="https://securedownloads.digi.me/partners/digime/SDKReadmeBanner.png" alt=""></p>

<p align="center">
    <a href="https://developers.digi.me/slack/join">
        <img src="https://img.shields.io/badge/chat-slack-blueviolet.svg" alt="Developer Chat">
    </a>
    <a href="https://github.com/digime/digime-sdk-ios/blob/master/LICENSE">
        <img src="https://img.shields.io/badge/license-apache 2.0-blue.svg" alt="Apache 2.0 License">
    </a>
    <a href="#">
        <img src="https://img.shields.io/badge/build-passing-brightgreen.svg">
    </a>
    <a href="https://swift.org">
        <img src="https://img.shields.io/badge/language-swift-orange.svg" alt="Swift">
    </a>
    <a href="https://developers.digi.me">
        <img src="https://img.shields.io/badge/web-digi.me-red.svg" alt="Web">
    </a>
    <a href="https://digime.freshdesk.com/support/solutions/9000115894">
        <img src="https://img.shields.io/badge/support-freshdesk-721744.svg" alt="Support">
    </a>
</p>

<p><br></p>
<h1 id='raw-data' class='heading'>Raw Data</h1>
<h2 id='introduction' class='heading'>Introduction</h2>

<p>digi.me prides itself in normalizing data from a huge array of sources into common ontologies, however, as a data portability facilitator, we support the flow of data in both directions - from the user to you, and from you back to the user.</p>

<p>To differentiate these types of data, we refer to these as follows:</p>

<ul>
<li>Data sources from external services, which is then normalized into differnet ontologies is referred to as <strong>mapped</strong> data.</li>
<li>Data written to a user&rsquo;s digi.me via this SDK is referred to as <strong>raw data</strong>.</li>
</ul>

<p>The digi.me Private Sharing SDK makes it easy to write data to a user&rsquo;s digi.me and read it back again.</p>
<h2 id='writing-raw-data' class='heading'>Writing Raw Data</h2>

<p>Before data can be written, you should already have credentials for this user.  If you don&rsquo;t have any, you will need to authorize the user first. Make sure the contract used is a <strong>WRITE</strong> contract.</p>

<p>To write the data, you need to build a <code>metadata</code> object that describes what data your pushing along with the <code>Data</code> representation of your data itself.</p>
<pre class="highlight swift"><code><span class="c1">// Obtain the data you wish to post.</span>
<span class="k">let</span> <span class="nv">data</span><span class="p">:</span> <span class="kt">Data</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1">// All push submissions must be pushed with appropriate metadata. The following is taken from one of the example apps.</span>
<span class="k">let</span> <span class="nv">metadata</span> <span class="o">=</span> <span class="kt">RawFileMetadataBuilder</span><span class="p">(</span><span class="nv">mimeType</span><span class="p">:</span> <span class="o">.</span><span class="n">applicationJson</span><span class="p">,</span> <span class="nv">accounts</span><span class="p">:</span> <span class="p">[</span><span class="s">"Account1"</span><span class="p">])</span>
                <span class="o">.</span><span class="nf">objectTypes</span><span class="p">([</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"receipt"</span><span class="p">)])</span>
                <span class="o">.</span><span class="nf">tags</span><span class="p">([</span><span class="s">"groceries"</span><span class="p">])</span>
                <span class="o">.</span><span class="nf">reference</span><span class="p">([</span><span class="s">"Receipt </span><span class="se">\(</span><span class="n">dateFormatter</span><span class="o">.</span><span class="nf">string</span><span class="p">(</span><span class="nv">from</span><span class="p">:</span> <span class="kt">Date</span><span class="p">())</span><span class="se">)</span><span class="s">"</span><span class="p">])</span>
                <span class="o">.</span><span class="nf">build</span><span class="p">()</span>

<span class="k">let</span> <span class="nv">credentials</span> <span class="o">=</span> <span class="n">my_stored_credentials</span>
<span class="n">digiMe</span><span class="o">.</span><span class="nf">write</span><span class="p">(</span><span class="nv">data</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span> <span class="nv">metadata</span><span class="p">:</span> <span class="n">metadata</span><span class="p">,</span> <span class="nv">credentials</span><span class="p">:</span> <span class="n">credentials</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
  <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">refreshedCredentials</span><span class="p">):</span>
        <span class="c1">// Update your stored credentials as these may have changed</span>

    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="c1">// Handle failure</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>
<h2 id='reading-raw-data' class='heading'>Reading Raw Data</h2>

<p>In order to read data which you have written to user&rsquo;s digi.me you will need a separate <strong>READ</strong> contract configured to read raw data. Please <a href="https://developers.digi.me/contact-us">contact support</a> to discuss this.</p>

<p>Reading raw data is similar to reading mapped data, in that you will need to authorize the user with this contract.  The only difference is that to access the same data space that your write contract has written to, you will also need to pass the credentials for you write contract.  This is because, by default, authorizing a contract creates a new data space - only by linking another contract will those contracts access the same data space.</p>

<p>You will also need to create a separate digi.me instance configured with your read contract.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">writeCredentials</span> <span class="o">=</span> <span class="n">my_write_credentials</span>

<span class="n">readDigiMe</span><span class="o">.</span><span class="nf">authorize</span><span class="p">(</span><span class="nv">linkToContractWithCredentials</span><span class="p">:</span> <span class="n">writeCredentials</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">credentials</span><span class="p">):</span>
        <span class="c1">// Store these credentials for your read contract</span>

    <span class="k">case</span><span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="c1">// Handle failure    }</span>
<span class="p">}</span>
</code></pre>

<p>Now you are ready to read the data you have written:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">credentials</span> <span class="o">=</span> <span class="n">my_stored_read_credentials</span>
<span class="n">readDigiMe</span><span class="o">.</span><span class="nf">readAllFiles</span><span class="p">(</span><span class="nv">credentials</span><span class="p">:</span> <span class="n">credentials</span><span class="p">,</span> <span class="nv">readOptions</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">file</span><span class="p">):</span>
        <span class="c1">// Access data or metadata of file.</span>

   <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
       <span class="c1">// Handle Error</span>
   <span class="p">}</span>
<span class="p">}</span> <span class="nv">completion</span><span class="p">:</span> <span class="p">{</span> <span class="n">result</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">result</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="p">(</span><span class="nv">fileList</span><span class="p">,</span> <span class="nv">refreshedCredentials</span><span class="p">)):</span>
        <span class="c1">// Handle success and update stored credentials as these may have been refreshed.</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">failure</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="c1">// Handle failure.</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>The returned file&rsquo;s <code>metadata</code> will be a <code>raw</code> type containing the actual metadata accompanying the data when it was written.</p>

<p><em>NB: Please refer to our Read/Write example in the <a href="https://github.com/digime/digime-sdk-ios/tree/master/Examples/DigiMeSDKExample">Example App</a> for a working example of this.</em></p>

          </div>
        </section>


      </article>
    </div>
    <section class="footer">
      <p>&copy; 2021 <a class="link" href="https://developers.digi.me" target="_blank" rel="external">digi.me</a>. All rights reserved. (Last updated: 2021-09-28)</p>
      <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.6</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
    </section>
  </body>
</div>
</html>
